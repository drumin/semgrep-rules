rules:
  - id: cve-2023-36189
    languages:
      - python
    severity: ERROR
    message: SQL injection vulnerability in langchain before v0.0.247 allows a
      remote attacker to obtain sensitive information via the SQLDatabaseChain
      component.
    fix: Upgrade to LangChain v0.0.247 or later and ensure proper input validation.
    patterns:
      - pattern-either:
          - pattern: $CHAIN(...)
          - pattern: $CHAIN.run(...)
      - pattern-inside:
          pattern-either:
            - pattern: |-
                $CHAIN = $IMPORT.SQLDatabaseChain(...)
                ...
            - pattern: |-
                $CHAIN = $IMPORT.SQLDatabaseChain.from_llm(...)
                ...
      - metavariable-pattern:
          metavariable: $IMPORT
          patterns:
            - pattern-either:
                - pattern: langchain
                - pattern: langchain_experimental
                - pattern-regex: ^(langchain(_experimental)?(\..+)?)$
